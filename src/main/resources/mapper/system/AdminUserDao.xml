<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lee.mht.system.dao.AdminUserDao">
    <resultMap id="baseResultMap" type="AdminUser">
        <id column="id" property="id"/>
        <result column="username" property="username" javaType="string"/>
        <result column="nickname" property="nickname" javaType="string"/>
        <result column="password" property="password" javaType="string"/>
        <result column="role_id" property="roleId"/>
        <result column="available" property="available" javaType="Boolean"/>
        <result column="createtime" property="createtime" jdbcType="TIMESTAMP"/>
        <result column="salt" property="salt" javaType="string"/>
    </resultMap>

    <select id="getAdminUserByUsername" parameterType="String" resultMap="baseResultMap">
        SELECT id,username,nickname,role_id,available FROM admin_user WHERE username = #{username}
    </select>

    <select id="login" parameterType="String" resultMap="baseResultMap">
        <!-- IFNULL(MAX( id ),0) 用来防止mybatis查询查不到结果时报错的问题 -->
        SELECT IFNULL(MAX( id ),0) AS id,username,password,nickname,role_id,available ,salt FROM admin_user
        WHERE username = #{username}
    </select>

    <select id="getpasswordByUsername" parameterType="String"   resultType="String">
        SELECT password FROM admin_user
        WHERE username = #{username}
    </select>

    <select id="getAllAdminUser"  resultMap="baseResultMap">
        SELECT id,username,nickname,role_id,available
        FROM admin_user
        <where>
            <if test="username != null and ! &quot;&quot;.equals(username)">
                <bind name="myUsername" value="'%' + username + '%'"/>
                username like #{myUsername}
            </if>
            <if test="nickname != null and ! &quot;&quot;.equals(nickname)">
                <bind name="myNickname" value="'%' + nickname + '%'"/>
                nickname like #{myNickname}
            </if>
            <if test="role_id != null">
                role_id = #{role_id}
            </if>
        </where>
    </select>
</mapper>